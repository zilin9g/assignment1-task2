<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>assignment1-task2</title>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
</head>
<body>
    <div class="card" style="width:400px">
        <img class="card-img-top" src="img/mp3.jpg" alt="Card image">
        <div class="card-body">
          <h4 class="card-title">MP3</h4>
          <p class="card-text">descript</p>
          <div id="bidForm">
            <form name="input" action="html_form_action.php" method="get">
                <div class="form-group">
                    <label for="bidderName">Bidder Name:</label>
                    <input type="text" class="form-control" id="bidderName">
                  </div>
                  <div class="form-group">
                    <label for="amount">Amount:</label>
                    <input type="text" class="form-control" id="amount">
                  </div>
                <input type="button" id="bid" class="btn btn-primary" value="Bid">
                </form>
            </div>
            <div id="bidderInfo">
                <p class="card-text">Bidder:<span id="bidderInfoName"></span></p>
                <p class="card-text">Amount:<span id="bidderInfoAmount"></span></p>
                <p id="winner" class="card-text text-primary"></p>
            </div>
        </div>
      </div>
    
</body>
</html>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script  type="text/javascript">
    $(document).ready(function(){
        $('#bid').click(function(){
            
            var bidderName=$('#bidderName').val();
            var amount=$('#amount').val();
            var parameters={
                bidderName:bidderName,
                amount:amount
            }
            $.get("http://localhost:3000/placebid",parameters,function(data){
                setTimeout(getBidder,1000);
            });
        })
        getBidder();
    })
    
    function getBidder()
    {
        $.get("http://localhost:3000/getBidder",null,function(data){
            if(data.timer>0)
            {
                $("#bidForm").attr("style","display:none;");
                $('#bidderInfo').attr("style","display:block;");
                
                $('#bidderInfoName').text(data.bidder.name);
                $('#bidderInfoAmount').text(data.bidder.amount);
                if(data.timer>=120)
                {
                    $('#winner').text(data.bidder.name+" is the winner.");
                }else{
                    $('#winner').text(data.timer+"seconds past.");
                    setTimeout(getBidder,1000);
                }
            }else{
                $('#bidderInfo').attr("style","display:none;");
            }
            
            
            });
    }
</script>